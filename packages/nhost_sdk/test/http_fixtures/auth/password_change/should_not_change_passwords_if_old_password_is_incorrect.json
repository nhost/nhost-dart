{
  "name": "auth/password_change/should_not_change_passwords_if_old_password_is_incorrect.json",
  "interactions": [
    {
      "request": {
        "method": "post",
        "uri": "http://localhost:9001/auth/register",
        "headers": {
          "content-type": "application/json; charset=utf-8"
        },
        "body": {
          "encoding": "utf-8",
          "string": "{\"email\":\"user-1@nhost.io\",\"password\":\"password-1\",\"user_data\":{},\"cookie\":false}"
        }
      },
      "response": {
        "status": 200,
        "headers": {
          "connection": "keep-alive",
          "surrogate-control": "no-store",
          "set-cookie": "refresh_token=; Path=/; Expires=Thu, 01 Jan 1970 00:00:00 GMT,permission_variables=; Path=/; Expires=Thu, 01 Jan 1970 00:00:00 GMT",
          "cache-control": "no-store, no-cache, must-revalidate, proxy-revalidate",
          "x-dns-prefetch-control": "off",
          "x-ratelimit-reset": "1634525484",
          "date": "Mon, 18 Oct 2021 02:37:49 GMT",
          "x-ratelimit-limit": "1000",
          "vary": "Origin",
          "strict-transport-security": "max-age=15552000; includeSubDomains",
          "x-ratelimit-remaining": "932",
          "content-type": "application/json; charset=utf-8",
          "pragma": "no-cache",
          "x-xss-protection": "1; mode=block",
          "access-control-allow-credentials": "true",
          "keep-alive": "timeout=5",
          "content-length": "612",
          "x-download-options": "noopen",
          "etag": "W/\"264-Qb1vMOsEdA2vRxKVzNob9LvjWqI\"",
          "x-frame-options": "SAMEORIGIN",
          "x-content-type-options": "nosniff",
          "expires": "0"
        },
        "body": {
          "encoding": "utf-8",
          "string": "{\"jwt_token\":\"eyJhbGciOiJIUzI1NiJ9.eyJodHRwczovL2hhc3VyYS5pby9qd3QvY2xhaW1zIjp7IngtaGFzdXJhLXVzZXItaWQiOiI5YWEyYjYzZS0zZTRhLTRmZWUtOTJiNy02NmQ5NzRjOGQ0MmUiLCJ4LWhhc3VyYS1hbGxvd2VkLXJvbGVzIjpbInVzZXIiLCJtZSJdLCJ4LWhhc3VyYS1kZWZhdWx0LXJvbGUiOiJ1c2VyIn0sInN1YiI6IjlhYTJiNjNlLTNlNGEtNGZlZS05MmI3LTY2ZDk3NGM4ZDQyZSIsImlzcyI6Im5ob3N0IiwiaWF0IjoxNjM0NTI0NjY5LCJleHAiOjE2MzQ1MjU1Njl9.G_A4eOkllbuBG0iFq3nmq5gtmWiNDe8IvGq3pwgWtq4\",\"jwt_expires_in\":900000,\"user\":{\"id\":\"9aa2b63e-3e4a-4fee-92b7-66d974c8d42e\",\"display_name\":\"user-1@nhost.io\",\"email\":\"user-1@nhost.io\"},\"refresh_token\":\"17f8a915-748a-45ae-b500-18dfb5b84dbb\"}"
        }
      }
    },
    {
      "request": {
        "method": "post",
        "uri": "http://localhost:9001/auth/change-password",
        "headers": {
          "content-type": "application/json; charset=utf-8",
          "authorization": "Bearer eyJhbGciOiJIUzI1NiJ9.eyJodHRwczovL2hhc3VyYS5pby9qd3QvY2xhaW1zIjp7IngtaGFzdXJhLXVzZXItaWQiOiI5YWEyYjYzZS0zZTRhLTRmZWUtOTJiNy02NmQ5NzRjOGQ0MmUiLCJ4LWhhc3VyYS1hbGxvd2VkLXJvbGVzIjpbInVzZXIiLCJtZSJdLCJ4LWhhc3VyYS1kZWZhdWx0LXJvbGUiOiJ1c2VyIn0sInN1YiI6IjlhYTJiNjNlLTNlNGEtNGZlZS05MmI3LTY2ZDk3NGM4ZDQyZSIsImlzcyI6Im5ob3N0IiwiaWF0IjoxNjM0NTI0NjY5LCJleHAiOjE2MzQ1MjU1Njl9.G_A4eOkllbuBG0iFq3nmq5gtmWiNDe8IvGq3pwgWtq4"
        },
        "body": {
          "encoding": "utf-8",
          "string": "{\"old_password\":\"wrong-old-password-1\",\"new_password\":\"new-password-1\"}"
        }
      },
      "response": {
        "status": 401,
        "headers": {
          "connection": "keep-alive",
          "surrogate-control": "no-store",
          "cache-control": "no-store, no-cache, must-revalidate, proxy-revalidate",
          "x-dns-prefetch-control": "off",
          "x-ratelimit-reset": "1634525484",
          "date": "Mon, 18 Oct 2021 02:37:49 GMT",
          "x-ratelimit-limit": "1000",
          "vary": "Origin",
          "strict-transport-security": "max-age=15552000; includeSubDomains",
          "x-ratelimit-remaining": "931",
          "content-type": "application/json; charset=utf-8",
          "pragma": "no-cache",
          "x-xss-protection": "1; mode=block",
          "access-control-allow-credentials": "true",
          "keep-alive": "timeout=5",
          "content-length": "81",
          "x-download-options": "noopen",
          "etag": "W/\"51-6XgWQM1/pIAEPSAk6bs20U59oJo\"",
          "x-frame-options": "SAMEORIGIN",
          "x-content-type-options": "nosniff",
          "expires": "0"
        },
        "body": {
          "encoding": "utf-8",
          "string": "{\"statusCode\":401,\"error\":\"Unauthorized\",\"message\":\"Incorrect current password.\"}"
        }
      }
    }
  ]
}
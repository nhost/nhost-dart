{
  "name": "auth/multi-factor_authentication/can_be_enabled_on_a_user.json",
  "interactions": [
    {
      "request": {
        "method": "post",
        "uri": "http://localhost:1337/v1/auth/signup/email-password",
        "headers": {
          "content-type": "application/json; charset=utf-8"
        },
        "body": {
          "encoding": "utf-8",
          "string": "{\"email\":\"user-1@nhost.io\",\"password\":\"password-1\"}"
        }
      },
      "response": {
        "status": 200,
        "headers": {
          "surrogate-control": "no-store",
          "cache-control": "no-store, no-cache, must-revalidate, proxy-revalidate",
          "x-dns-prefetch-control": "off",
          "date": "Thu, 03 Feb 2022 08:55:15 GMT",
          "access-control-allow-origin": "*",
          "strict-transport-security": "max-age=15552000; includeSubDomains",
          "content-type": "application/json; charset=utf-8",
          "pragma": "no-cache",
          "x-xss-protection": "1; mode=block",
          "content-length": "913",
          "x-download-options": "noopen",
          "etag": "W/\"391-bgVzX+IOQwok2dNs7FB8qDrpib4\"",
          "x-frame-options": "SAMEORIGIN",
          "x-content-type-options": "nosniff",
          "expires": "0"
        },
        "body": {
          "encoding": "utf-8",
          "string": "{\"session\":{\"accessToken\":\"eyJhbGciOiJIUzI1NiJ9.eyJodHRwczovL2hhc3VyYS5pby9qd3QvY2xhaW1zIjp7IngtaGFzdXJhLWFsbG93ZWQtcm9sZXMiOlsidXNlciIsIm1lIl0sIngtaGFzdXJhLWRlZmF1bHQtcm9sZSI6InVzZXIiLCJ4LWhhc3VyYS11c2VyLWlkIjoiNzQ0NzgzODctZjc3Yi00MDMyLTk5YzUtNWRlZmFhZDVmMTFkIiwieC1oYXN1cmEtdXNlci1pc0Fub255bW91cyI6ImZhbHNlIn0sInN1YiI6Ijc0NDc4Mzg3LWY3N2ItNDAzMi05OWM1LTVkZWZhYWQ1ZjExZCIsImlzcyI6Imhhc3VyYS1hdXRoIiwiaWF0IjoxNjQzODc4NTE1LCJleHAiOjE2NDM4Nzk0MTV9.3c51GKgj-gTwRgQ7JxLzOuP7-5qmUkdH7HGB05sLxlQ\",\"accessTokenExpiresIn\":900,\"refreshToken\":\"a721c5df-7a8b-40bb-acbd-071ac63ac376\",\"user\":{\"id\":\"74478387-f77b-4032-99c5-5defaad5f11d\",\"createdAt\":\"2022-02-03T08:55:15.544189+00:00\",\"displayName\":\"user-1@nhost.io\",\"avatarUrl\":\"https://s.gravatar.com/avatar/d86c12c3233e91ec90869a1f874cdf0e?r=g&default=blank\",\"locale\":\"en\",\"email\":\"user-1@nhost.io\",\"isAnonymous\":false,\"defaultRole\":\"user\",\"roles\":[\"user\",\"me\"]}},\"mfa\":null}"
        }
      }
    },
    {
      "request": {
        "method": "get",
        "uri": "http://localhost:1337/v1/auth/mfa/totp/generate",
        "headers": {
          "authorization": "Bearer eyJhbGciOiJIUzI1NiJ9.eyJodHRwczovL2hhc3VyYS5pby9qd3QvY2xhaW1zIjp7IngtaGFzdXJhLWFsbG93ZWQtcm9sZXMiOlsidXNlciIsIm1lIl0sIngtaGFzdXJhLWRlZmF1bHQtcm9sZSI6InVzZXIiLCJ4LWhhc3VyYS11c2VyLWlkIjoiNzQ0NzgzODctZjc3Yi00MDMyLTk5YzUtNWRlZmFhZDVmMTFkIiwieC1oYXN1cmEtdXNlci1pc0Fub255bW91cyI6ImZhbHNlIn0sInN1YiI6Ijc0NDc4Mzg3LWY3N2ItNDAzMi05OWM1LTVkZWZhYWQ1ZjExZCIsImlzcyI6Imhhc3VyYS1hdXRoIiwiaWF0IjoxNjQzODc4NTE1LCJleHAiOjE2NDM4Nzk0MTV9.3c51GKgj-gTwRgQ7JxLzOuP7-5qmUkdH7HGB05sLxlQ"
        },
        "body": null
      },
      "response": {
        "status": 200,
        "headers": {
          "surrogate-control": "no-store",
          "cache-control": "no-store, no-cache, must-revalidate, proxy-revalidate",
          "x-dns-prefetch-control": "off",
          "date": "Thu, 03 Feb 2022 08:55:15 GMT",
          "access-control-allow-origin": "*",
          "strict-transport-security": "max-age=15552000; includeSubDomains",
          "content-type": "application/json; charset=utf-8",
          "pragma": "no-cache",
          "x-xss-protection": "1; mode=block",
          "content-length": "4413",
          "x-download-options": "noopen",
          "etag": "W/\"113d-h6bu2WuKlLYhT/f7PJfN4d6GLMA\"",
          "x-frame-options": "SAMEORIGIN",
          "x-content-type-options": "nosniff",
          "expires": "0"
        },
        "body": {
          "encoding": "utf-8",
          "string": "{\"imageUrl\":\"data:image/png;base64,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\",\"totpSecret\":\"GJWQGHJCFBNASKBY\"}"
        }
      }
    },
    {
      "request": {
        "method": "post",
        "uri": "http://localhost:1337/v1/auth/user/mfa",
        "headers": {
          "content-type": "application/json; charset=utf-8",
          "authorization": "Bearer eyJhbGciOiJIUzI1NiJ9.eyJodHRwczovL2hhc3VyYS5pby9qd3QvY2xhaW1zIjp7IngtaGFzdXJhLWFsbG93ZWQtcm9sZXMiOlsidXNlciIsIm1lIl0sIngtaGFzdXJhLWRlZmF1bHQtcm9sZSI6InVzZXIiLCJ4LWhhc3VyYS11c2VyLWlkIjoiNzQ0NzgzODctZjc3Yi00MDMyLTk5YzUtNWRlZmFhZDVmMTFkIiwieC1oYXN1cmEtdXNlci1pc0Fub255bW91cyI6ImZhbHNlIn0sInN1YiI6Ijc0NDc4Mzg3LWY3N2ItNDAzMi05OWM1LTVkZWZhYWQ1ZjExZCIsImlzcyI6Imhhc3VyYS1hdXRoIiwiaWF0IjoxNjQzODc4NTE1LCJleHAiOjE2NDM4Nzk0MTV9.3c51GKgj-gTwRgQ7JxLzOuP7-5qmUkdH7HGB05sLxlQ"
        },
        "body": {
          "encoding": "utf-8",
          "string": "{\"code\":\"032308\",\"activeMfaType\":\"totp\"}"
        }
      },
      "response": {
        "status": 200,
        "headers": {
          "surrogate-control": "no-store",
          "cache-control": "no-store, no-cache, must-revalidate, proxy-revalidate",
          "x-dns-prefetch-control": "off",
          "date": "Thu, 03 Feb 2022 08:55:15 GMT",
          "access-control-allow-origin": "*",
          "strict-transport-security": "max-age=15552000; includeSubDomains",
          "content-type": "text/html; charset=utf-8",
          "pragma": "no-cache",
          "x-xss-protection": "1; mode=block",
          "content-length": "2",
          "x-download-options": "noopen",
          "etag": "W/\"2-nOO9QiTIwXgNtWtBJezz8kv3SLc\"",
          "x-frame-options": "SAMEORIGIN",
          "x-content-type-options": "nosniff",
          "expires": "0"
        },
        "body": {
          "encoding": "utf-8",
          "string": "OK"
        }
      }
    }
  ]
}
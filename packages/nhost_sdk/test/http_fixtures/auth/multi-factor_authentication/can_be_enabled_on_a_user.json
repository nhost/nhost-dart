{
  "name": "auth/multi-factor_authentication/can_be_enabled_on_a_user.json",
  "interactions": [
    {
      "request": {
        "method": "post",
        "uri": "http://localhost:9001/auth/register",
        "headers": {
          "content-type": "application/json; charset=utf-8"
        },
        "body": {
          "encoding": "utf-8",
          "string": "{\"email\":\"user-1@nhost.io\",\"password\":\"password-1\",\"user_data\":{},\"cookie\":false}"
        }
      },
      "response": {
        "status": 200,
        "headers": {
          "connection": "keep-alive",
          "surrogate-control": "no-store",
          "set-cookie": "refresh_token=; Path=/; Expires=Thu, 01 Jan 1970 00:00:00 GMT,permission_variables=; Path=/; Expires=Thu, 01 Jan 1970 00:00:00 GMT",
          "cache-control": "no-store, no-cache, must-revalidate, proxy-revalidate",
          "x-dns-prefetch-control": "off",
          "x-ratelimit-reset": "1634525484",
          "date": "Mon, 18 Oct 2021 02:37:50 GMT",
          "x-ratelimit-limit": "1000",
          "vary": "Origin",
          "strict-transport-security": "max-age=15552000; includeSubDomains",
          "x-ratelimit-remaining": "925",
          "content-type": "application/json; charset=utf-8",
          "pragma": "no-cache",
          "x-xss-protection": "1; mode=block",
          "access-control-allow-credentials": "true",
          "keep-alive": "timeout=5",
          "content-length": "612",
          "x-download-options": "noopen",
          "etag": "W/\"264-U1WmgU/WhcOASQ5Kq1F+Ja1OQ+4\"",
          "x-frame-options": "SAMEORIGIN",
          "x-content-type-options": "nosniff",
          "expires": "0"
        },
        "body": {
          "encoding": "utf-8",
          "string": "{\"jwt_token\":\"eyJhbGciOiJIUzI1NiJ9.eyJodHRwczovL2hhc3VyYS5pby9qd3QvY2xhaW1zIjp7IngtaGFzdXJhLXVzZXItaWQiOiJkYjBhNDRjMi1hMTRlLTQzOWItOTNhMC1lMGY3Mzk1NGJmMmUiLCJ4LWhhc3VyYS1hbGxvd2VkLXJvbGVzIjpbInVzZXIiLCJtZSJdLCJ4LWhhc3VyYS1kZWZhdWx0LXJvbGUiOiJ1c2VyIn0sInN1YiI6ImRiMGE0NGMyLWExNGUtNDM5Yi05M2EwLWUwZjczOTU0YmYyZSIsImlzcyI6Im5ob3N0IiwiaWF0IjoxNjM0NTI0NjcxLCJleHAiOjE2MzQ1MjU1NzF9.roLHdHhbjhajsenYS2kNzPE-FNwlOTSpoWhjItYSpoo\",\"jwt_expires_in\":900000,\"user\":{\"id\":\"db0a44c2-a14e-439b-93a0-e0f73954bf2e\",\"display_name\":\"user-1@nhost.io\",\"email\":\"user-1@nhost.io\"},\"refresh_token\":\"e57978b6-f56d-444c-8221-15e10ceae105\"}"
        }
      }
    },
    {
      "request": {
        "method": "post",
        "uri": "http://localhost:9001/auth/mfa/generate",
        "headers": {
          "content-type": "application/json; charset=utf-8",
          "authorization": "Bearer eyJhbGciOiJIUzI1NiJ9.eyJodHRwczovL2hhc3VyYS5pby9qd3QvY2xhaW1zIjp7IngtaGFzdXJhLXVzZXItaWQiOiJkYjBhNDRjMi1hMTRlLTQzOWItOTNhMC1lMGY3Mzk1NGJmMmUiLCJ4LWhhc3VyYS1hbGxvd2VkLXJvbGVzIjpbInVzZXIiLCJtZSJdLCJ4LWhhc3VyYS1kZWZhdWx0LXJvbGUiOiJ1c2VyIn0sInN1YiI6ImRiMGE0NGMyLWExNGUtNDM5Yi05M2EwLWUwZjczOTU0YmYyZSIsImlzcyI6Im5ob3N0IiwiaWF0IjoxNjM0NTI0NjcxLCJleHAiOjE2MzQ1MjU1NzF9.roLHdHhbjhajsenYS2kNzPE-FNwlOTSpoWhjItYSpoo"
        },
        "body": {
          "encoding": "utf-8",
          "string": "{}"
        }
      },
      "response": {
        "status": 200,
        "headers": {
          "connection": "keep-alive",
          "surrogate-control": "no-store",
          "cache-control": "no-store, no-cache, must-revalidate, proxy-revalidate",
          "x-dns-prefetch-control": "off",
          "x-ratelimit-reset": "1634525484",
          "date": "Mon, 18 Oct 2021 02:37:51 GMT",
          "x-ratelimit-limit": "1000",
          "vary": "Origin",
          "strict-transport-security": "max-age=15552000; includeSubDomains",
          "x-ratelimit-remaining": "924",
          "content-type": "application/json; charset=utf-8",
          "pragma": "no-cache",
          "x-xss-protection": "1; mode=block",
          "access-control-allow-credentials": "true",
          "keep-alive": "timeout=5",
          "content-length": "3774",
          "x-download-options": "noopen",
          "etag": "W/\"ebe-IgjHH6vFbGXSQIUQhVbm7RlHNN4\"",
          "x-frame-options": "SAMEORIGIN",
          "x-content-type-options": "nosniff",
          "expires": "0"
        },
        "body": {
          "encoding": "utf-8",
          "string": "{\"image_url\":\"data:image/png;base64,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\",\"otp_secret\":\"HQGAIPLJLB7WSUJX\"}"
        }
      }
    },
    {
      "request": {
        "method": "post",
        "uri": "http://localhost:9001/auth/mfa/enable",
        "headers": {
          "content-type": "application/json; charset=utf-8",
          "authorization": "Bearer eyJhbGciOiJIUzI1NiJ9.eyJodHRwczovL2hhc3VyYS5pby9qd3QvY2xhaW1zIjp7IngtaGFzdXJhLXVzZXItaWQiOiJkYjBhNDRjMi1hMTRlLTQzOWItOTNhMC1lMGY3Mzk1NGJmMmUiLCJ4LWhhc3VyYS1hbGxvd2VkLXJvbGVzIjpbInVzZXIiLCJtZSJdLCJ4LWhhc3VyYS1kZWZhdWx0LXJvbGUiOiJ1c2VyIn0sInN1YiI6ImRiMGE0NGMyLWExNGUtNDM5Yi05M2EwLWUwZjczOTU0YmYyZSIsImlzcyI6Im5ob3N0IiwiaWF0IjoxNjM0NTI0NjcxLCJleHAiOjE2MzQ1MjU1NzF9.roLHdHhbjhajsenYS2kNzPE-FNwlOTSpoWhjItYSpoo"
        },
        "body": {
          "encoding": "utf-8",
          "string": "{\"code\":\"707036\"}"
        }
      },
      "response": {
        "status": 204,
        "headers": {
          "connection": "keep-alive",
          "surrogate-control": "no-store",
          "cache-control": "no-store, no-cache, must-revalidate, proxy-revalidate",
          "x-dns-prefetch-control": "off",
          "x-ratelimit-reset": "1634525484",
          "date": "Mon, 18 Oct 2021 02:37:51 GMT",
          "x-ratelimit-limit": "1000",
          "vary": "Origin",
          "strict-transport-security": "max-age=15552000; includeSubDomains",
          "x-ratelimit-remaining": "923",
          "pragma": "no-cache",
          "x-xss-protection": "1; mode=block",
          "access-control-allow-credentials": "true",
          "keep-alive": "timeout=5",
          "x-download-options": "noopen",
          "x-frame-options": "SAMEORIGIN",
          "x-content-type-options": "nosniff",
          "expires": "0"
        },
        "body": {
          "encoding": "iso-8859-1",
          "string": ""
        }
      }
    }
  ]
}